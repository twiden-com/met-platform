
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medha Edu Tech - New Enquiry</title>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/carbon-components/10.58.12/css/carbon-components.min.css">
    <link rel="stylesheet" href="https://unpkg.com/@carbon/styles@1.32.0/css/styles.min.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10/dist/ext/response-targets.js"></script>
    <style>
        :root {
            --color-navy: #1e3a8a;
            --color-orange: #f97316;
            --color-white: #ffffff;
            --color-gray-bg: #f2f4f8;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'IBM Plex Sans', sans-serif;
            background: var(--color-gray-bg);
            min-height: 100vh;
        }

        .app-header {
            background: var(--color-navy);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.15s ease;
            padding: 0.5rem;
            border-radius: 4px;
        }

        .back-link:hover {
            color: white;
            background: rgba(255, 255, 255, 0.1);
        }

        .page-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: white;
            margin: 0;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            letter-spacing: -0.02em;
        }

        .logo-accent {
            color: var(--color-orange);
        }

        .main-container {
            max-width: 700px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .form-container {
            background: white;
            border-radius: 8px;
            padding: 3rem;
            border: 1px solid #e0e0e0;
        }

        .bx--form-item {
            margin-bottom: 2rem;
        }

        .bx--label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #161616;
            margin-bottom: 0.5rem;
            line-height: 1.29;
        }

        .bx--text-input,
        .bx--text-area,
        .bx--select-input {
            width: 100%;
            height: 2.5rem;
            padding: 0 1rem;
            font-size: 0.875rem;
            font-family: inherit;
            color: #161616;
            background-color: #f4f4f4;
            border: none;
            border-bottom: 1px solid #8d8d8d;
            outline: none;
            transition: all 0.11s cubic-bezier(0.2, 0, 0.38, 0.9);
        }

        .bx--text-area {
            height: auto;
            padding: 0.75rem 1rem;
            resize: vertical;
        }

        .bx--text-input:focus,
        .bx--text-area:focus,
        .bx--select-input:focus {
            border-bottom: 2px solid #0f62fe;
            background-color: white;
        }

        .bx--select {
            position: relative;
        }

        .bx--select__arrow {
            position: absolute;
            top: 50%;
            right: 1rem;
            transform: translateY(-50%);
            pointer-events: none;
            fill: #161616;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .form-grid-full {
            grid-column: 1 / -1;
        }

        /* Phone Input Layout */
        .phone-container {
            display: flex;
            gap: 0.5rem;
            
            width: 100%;
            align-items: end;
			
        }

        .country-code {
            flex: 0 0 90px;
        }

        .phone-input-field {
            flex: 1;
            min-width: 0; /* Allows flex item to shrink below content size */
        }

        .send-otp-container {
            flex: 0 0 100px;
        }

        .send-otp-btn {
            width: 100%;
            height: 2.5rem;
            font-size: 0.875rem;
			padding:15px !important;
        }

        /* OTP Input Boxes */
        .otp-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .otp-boxes {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin: 1rem 0;
        }

        .otp-box {
            width: 3rem;
            height: 3rem;
            text-align: center;
            font-size: 1.25rem;
            font-weight: 600;
            border: 2px solid #8d8d8d;
            border-radius: 4px;
            background: #f4f4f4;
            outline: none;
            transition: all 0.11s cubic-bezier(0.2, 0, 0.38, 0.9);
        }

        .otp-box:focus {
            border-color: #0f62fe;
            background: white;
        }

        .otp-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .otp-timer {
            font-size: 0.875rem;
            color: #6f6f6f;
        }

        .edit-phone-link {
            color: #0f62fe;
            text-decoration: none;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .edit-phone-link:hover {
            text-decoration: underline;
        }

        .verified-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #24a148;
            font-weight: 500;
            margin-top: 0.5rem;
        }

        .verified-icon {
            width: 20px;
            height: 20px;
            background: #24a148;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        /* Checkbox Fieldset */
        .bx--fieldset {
            border: none;
            margin: 0;
            padding: 0;
        }

        .courses-container {
            background: #f4f4f4;
            padding: 1.5rem;
            border-radius: 4px;
            margin-top: 0.5rem;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .bx--checkbox-wrapper {
            position: relative;
            display: flex;
            align-items: flex-start;
            margin-bottom: 0;
        }

        .bx--checkbox {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .bx--checkbox-label {
            position: relative;
            display: flex;
            align-items: flex-start;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 400;
            line-height: 1.29;
            color: #161616;
            user-select: none;
            padding-left: 2rem;
            min-height: 1.5rem;
        }

        .bx--checkbox-label-text {
            padding-left: 0;
        }

        .bx--checkbox-label::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.125rem;
            width: 1rem;
            height: 1rem;
            border: 1px solid #8d8d8d;
            background-color: #f4f4f4;
            border-radius: 0;
            transition: all 0.11s cubic-bezier(0.2, 0, 0.38, 0.9);
        }

        .bx--checkbox:checked + .bx--checkbox-label::before {
            background-color: #0f62fe;
            border-color: #0f62fe;
        }

        .bx--checkbox:checked + .bx--checkbox-label::after {
            content: '';
            position: absolute;
            left: 0.25rem;
            top: 0.375rem;
            width: 0.5rem;
            height: 0.25rem;
            border-left: 2px solid white;
            border-bottom: 2px solid white;
            transform: rotate(-45deg);
        }

        .bx--checkbox:focus + .bx--checkbox-label::before {
            border-color: #0f62fe;
            box-shadow: 0 0 0 2px #0f62fe;
        }

        /* Individual checkbox option */
        .single-checkbox {
            margin-top: 1rem;
        }

        /* Success Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 3rem;
            text-align: center;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .success-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1.5rem;
            background: #24a148;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #161616;
            margin-bottom: 0.75rem;
        }

        .modal-message {
            color: #6f6f6f;
            margin-bottom: 2rem;
        }

        /* Form Actions */
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #e0e0e0;
        }

        /* Loading State */
        .htmx-indicator {
            display: none;
        }

        .htmx-request .htmx-indicator {
            display: inline-flex;
            align-items: center;
            margin-left: 0.5rem;
        }

        .loading-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--color-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Alert Messages */
        .alert-message {
            margin-bottom: 2rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .header-left {
                gap: 1rem;
            }
            
            .main-container {
                padding: 2rem 1rem;
            }
            
            .form-container {
                padding: 2rem 1.5rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .phone-container {
                gap: 0.5rem;
            }

            .country-code {
                flex: 0 0 75px;
            }

            .send-otp-container {
                flex: 0 0 85px;
            }

            .send-otp-btn {
                font-size: 0.75rem;
            }

            .courses-grid {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .otp-boxes {
                gap: 0.25rem;
                justify-content: space-between;
            }

            .otp-box {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1rem;
            }

            .otp-controls {
                flex-direction: column;
                gap: 0.5rem;
                align-items: center;
            }
        }

        @media (max-width: 480px) {
            .form-container {
                padding: 1.5rem 1rem;
            }

            .country-code {
                flex: 0 0 65px;
            }

            .phone-container {
                gap: 0.25rem;
            }

            .otp-box {
                width: 2rem;
                height: 2rem;
                font-size: 0.875rem;
            }

            .send-otp-btn {
                width: 100%;
                margin-top: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <!-- App Header -->
    <div class="app-header">
        <div class="header-left">
            <a href="/counsellor/dashboard" class="back-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.42-1.41L7.83 13H20v-2z"/>
                </svg>
                Dashboard
            </a>
            <h1 class="page-title">New Student Enquiry</h1>
        </div>
        <div class="logo">
            Medha<span class="logo-accent">EduTech</span>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <div class="form-container">
            <div id="form-response" class="alert-message"></div>

            <form hx-post="/api/enquiry/create" 
                  hx-target="#form-response" 
                  hx-swap="innerHTML" 
                  hx-ext="response-targets"
                  hx-indicator="#submit-loading">
                
                <!-- Student Details -->
                <div class="form-grid">
                    <div class="bx--form-item">
                        <label for="student-name" class="bx--label">Student Name *</label>
                        <input type="text" id="student-name" name="student_name" class="bx--text-input" placeholder="Enter full name" required>
                    </div>
                    <div class="bx--form-item">
                        <label for="location" class="bx--label">Location</label>
                        <input type="text" id="location" name="location" class="bx--text-input" placeholder="Enter city">
                    </div>
                </div>

                <!-- Phone with OTP Flow -->
                <div class="bx--form-item form-grid-full">
                    <label class="bx--label">Phone Number *</label>
                    
                    <!-- Initial Phone Input State -->
                    <div id="phone-input-section" style="width:100%">
                        <div class="phone-container">
                            <div class="bx--form-item country-code">
                                <div class="bx--select">
                                    <select name="country_code" class="bx--select-input" id="country-code">
                                        <option value="+91" selected>+91</option>
                                        <option value="+1">+1</option>
                                        <option value="+44">+44</option>
                                    </select>
                                    <svg class="bx--select__arrow" width="16" height="16" viewBox="0 0 16 16">
                                        <path d="m8 11L3 6l.7-.7L8 9.6l4.3-4.3L13 6z"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="bx--form-item phone-input-field">
                                <input type="tel" id="phone-input" name="phone" class="bx--text-input" placeholder="10-digit number" required pattern="[0-9]{10}" maxlength="10">
                            </div>
                            <div class="bx--form-item send-otp-container">
                                <button type="button" class="bx--btn bx--btn--tertiary bx--btn--sm send-otp-btn" 
                                        hx-post="/api/send-otp" 
                                        hx-include="#phone-input, #country-code"
                                        hx-target="#phone-input-section"
                                        hx-swap="outerHTML">
                                    Send OTP
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Education & Lead Info -->
                <div class="form-grid">
                    <div class="bx--form-item">
                        <label for="degree" class="bx--label">Education Level</label>
                        <div class="bx--select">
                            <select id="degree" name="degree" class="bx--select-input">
                                <option value="">Select education level</option>
                                <option value="below_10th">< 10th</option>
                                <option value="inter_completed">Inter Completed</option>
                                <option value="btech_passout">B. Tech Pass out</option>
                                <option value="btech_studying">B. Tech Studying</option>
                                <option value="masters">Masters</option>
                                <option value="other">Other</option>
                            </select>
                            <svg class="bx--select__arrow" width="16" height="16" viewBox="0 0 16 16">
                                <path d="m8 11L3 6l.7-.7L8 9.6l4.3-4.3L13 6z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="bx--form-item">
                        <label for="lead-source" class="bx--label">Lead Source</label>
                        <div class="bx--select">
                            <select id="lead-source" name="lead_source" class="bx--select-input">
                                <option value="">Select lead source</option>
                                <option value="social_media">Social Media</option>
                                <option value="marketing_ravi">Marketing - Ravi</option>
                                <option value="marketing_ashok">Marketing - Ashok</option>
                                <option value="student_referral">Student Referral</option>
                                <option value="direct_walkin">Direct Walk-in</option>
                            </select>
                            <svg class="bx--select__arrow" width="16" height="16" viewBox="0 0 16 16">
                                <path d="m8 11L3 6l.7-.7L8 9.6l4.3-4.3L13 6z"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="bx--form-item">
                        <label for="counselled-by" class="bx--label">Counselled by</label>
                        <div class="bx--select">
                            <select id="counselled-by" name="counselled_by" class="bx--select-input">
                                <option value="">Select counsellor</option>
                                <option value="ushmika">Ushmika</option>
                                <option value="pallavi">Pallavi</option>
                                <option value="taniath">Taniath</option>
                                <option value="other">Other</option>
                            </select>
                            <svg class="bx--select__arrow" width="16" height="16" viewBox="0 0 16 16">
                                <path d="m8 11L3 6l.7-.7L8 9.6l4.3-4.3L13 6z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="bx--form-item">
                        <label for="urgency" class="bx--label">Timeline</label>
                        <div class="bx--select">
                            <select id="urgency" name="urgency" class="bx--select-input">
                                <option value="">Select timeline</option>
                                <option value="immediately">Immediately</option>
                                <option value="one_week">One week</option>
                                <option value="2_3_weeks">2 - 3 weeks</option>
                                <option value="one_month">One month</option>
                                <option value="two_months">2 months</option>
                            </select>
                            <svg class="bx--select__arrow" width="16" height="16" viewBox="0 0 16 16">
                                <path d="m8 11L3 6l.7-.7L8 9.6l4.3-4.3L13 6z"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Interested Courses -->
                <div class="bx--form-item form-grid-full">
                    <label class="bx--label">Interested Courses *</label>
                    <fieldset class="bx--fieldset">
                        <div class="courses-container">
                            <div class="courses-grid">
                                <div class="bx--checkbox-wrapper">
                                    <input type="checkbox" id="course-1" name="interested_courses" value="data_science_ai" class="bx--checkbox">
                                    <label for="course-1" class="bx--checkbox-label">
                                        <span class="bx--checkbox-label-text">Data Science with AI</span>
                                    </label>
                                </div>
                                <div class="bx--checkbox-wrapper">
                                    <input type="checkbox" id="course-2" name="interested_courses" value="python_fullstack_ai" class="bx--checkbox">
                                    <label for="course-2" class="bx--checkbox-label">
                                        <span class="bx--checkbox-label-text">Python Full Stack with AI</span>
                                    </label>
                                </div>
                                <div class="bx--checkbox-wrapper">
                                    <input type="checkbox" id="course-3" name="interested_courses" value="digital_marketing_ai" class="bx--checkbox">
                                    <label for="course-3" class="bx--checkbox-label">
                                        <span class="bx--checkbox-label-text">Digital Marketing with AI</span>
                                    </label>
                                </div>
                                <div class="bx--checkbox-wrapper">
                                    <input type="checkbox" id="course-4" name="interested_courses" value="cybersecurity" class="bx--checkbox">
                                    <label for="course-4" class="bx--checkbox-label">
                                        <span class="bx--checkbox-label-text">Cybersecurity</span>
                                    </label>
                                </div>
                                <div class="bx--checkbox-wrapper">
                                    <input type="checkbox" id="course-5" name="interested_courses" value="java_fullstack_ai" class="bx--checkbox">
                                    <label for="course-5" class="bx--checkbox-label">
                                        <span class="bx--checkbox-label-text">Java Full Stack with AI</span>
                                    </label>
                                </div>
                                <div class="bx--checkbox-wrapper">
                                    <input type="checkbox" id="course-6" name="interested_courses" value="data_analytics_genai" class="bx--checkbox">
                                    <label for="course-6" class="bx--checkbox-label">
                                        <span class="bx--checkbox-label-text">Data Analytics & Gen AI</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <!-- Comments -->
                <div class="bx--form-item">
                    <label for="comments" class="bx--label">Comments</label>
                    <textarea id="comments" name="comments" class="bx--text-area" rows="3" placeholder="Additional notes or requirements..."></textarea>
                </div>

                <!-- Send Brochure -->
                <div class="bx--checkbox-wrapper single-checkbox">
                    <input type="checkbox" id="send-brochure" name="send_brochure" class="bx--checkbox" value="true" checked>
                    <label for="send-brochure" class="bx--checkbox-label">
                        <span class="bx--checkbox-label-text">Send brochure via WhatsApp</span>
                    </label>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="bx--btn bx--btn--secondary" onclick="window.history.back()">
                        Cancel
                    </button>
                    <button type="submit" class="bx--btn bx--btn--primary">
                        Create Enquiry
                        <span id="submit-loading" class="htmx-indicator">
                            <div class="loading-spinner"></div>
                        </span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="success-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
            </div>
            <h2 class="modal-title">Enquiry Created Successfully!</h2>
            <p class="modal-message">Student details have been saved and follow-up actions initiated.</p>
            <button class="bx--btn bx--btn--primary" onclick="window.location.href='/counsellor/dashboard'">
                OK
            </button>
        </div>
    </div>

    <script>
        // Phone number validation only
        document.getElementById('phone-input').addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);
        });

        // Handle HTMX responses
        document.addEventListener('htmx:afterRequest', function(event) {
            if (event.detail.xhr.responseURL.includes('/api/enquiry/create')) {
                if (event.detail.xhr.status === 200) {
                    document.getElementById('success-modal').style.display = 'flex';
                }
            }
        });

        // Form validation
        document.querySelector('form').addEventListener('submit', function(e) {
            const studentName = document.getElementById('student-name').value.trim();
            const phone = document.querySelector('input[name="phone"]').value.trim();
            const courses = document.querySelectorAll('input[name="interested_courses"]:checked');
            
            if (!studentName) {
                alert('Please enter student name');
                e.preventDefault();
                return;
            }
            
            if (!phone || phone.length !== 10) {
                alert('Please enter a valid 10-digit phone number');
                e.preventDefault();
                return;
            }
            
            if (courses.length === 0) {
                alert('Please select at least one interested course');
                e.preventDefault();
                return;
            }
        });
    </script>
</body>
</html>